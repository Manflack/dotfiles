#!/usr/bin/env bash

set -euo pipefail

source "$DOTFILES_PATH/scripts/core/_main.sh"

current_timestamp() { date +%s; }

create_dir_if_not_exists(){
  if ! [ -f "$1" ]; then
      mkdir "$1"
  fi
}

mv_if_file_exists(){
  if [ -f $1 ]; then
      mv "$1" "$1.$(current_timestamp).back"
  fi
}

##? Setup VsCode configs
#?? 1.0.0
##?
##? Usage:
##?   setup
docs::parse "$@"

if platform::is_macos; then
		create_dir_if_not_exists ~/Library/Application\ Support/Code/User
    mv_if_file_exists ~/Library/Application\ Support/Code/User/settings.json
    ln -s $DOTFILES_PATH/editors/vscode/settings.json ~/Library/Application\ Support/Code/User/settings.json
elif platform::is_linux; then
		create_dir_if_not_exists ~/.config/Code/User
    mv_if_file_exists ~/.config/Code/User/settings.json
    ln -s $DOTFILES_PATH/editors/vscode/settings.json ~/.config/Code/User/settings.json
elif platform::is_wsl; then
		create_dir_if_not_exists $WINHOME/AppData/Roaming/Code/User
    mv_if_file_exists $WINHOME/AppData/Roaming/Code/User/settings.json
    ln -s $DOTFILES_PATH/editors/vscode/settings.json $WINHOME/AppData/Roaming/Code/User/settings.json
fi